{% extends 'shoppage/basic.html' %}
{% block css %}
<style>
  .carousel-item img {
    width: auto;
    height: 500px;
  }
  /* .carousel-item ,.carousel-item:active{
 
width:max-content;
  } */
  .col-md-3 {
    display: inline-block;
    margin-left: -4px;
  }

  #popcart {
    background-color: #87142b;
    border: #87142b;

  }

  .carousel-indicators .active {
    background-color: blue;
  }

  .col-md-3 img {
    max-width: 260px;
    max-height: 242px;
  }

  .col-lg-3 img {
    max-width: 235px;
    max-height: 290px;
  }

  body .carousel-indicator li {
    background-color: blue;
  }

  .card {
    width: 240px;
  }

  body .carousel-indicators {
    bottom: 0;
  }

  .carousel-control-prev-icon,
  body .carousel-control-next-icon {
    background-color: #87142b;
  }

  .carousel-control-prev,
  .carousel-control-next {
    top: auto;
    bottom: auto;
    padding-top: 222px;
  }

  body .no-padding {
    padding-left: 0;
    padding-right: 0;
  }

  .card-text {
    width: 200px;
    height: 50px;
    overflow: hidden;

  }

  .price {
    color: blue;
    font-weight: bold;
  }

  .marketing {
    text-align: center;
    box-shadow: 2px solid black;
  }

  .btn-secondry {
    background-color: #87142b;
  }

  .flip-card {
    background-color: transparent;
    width: 300px;
    height: 200px;
    perspective: 1000px;
    /* Remove this if you don't want the 3D effect */
  }

  /* This container is needed to position the front and back side */
  .flip-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    text-align: center;
    transition: transform 0.8s;
    transform-style: preserve-3d;
    margin-bottom: 90px;
  }

  /* Do an horizontal flip when you move the mouse over the flip box container */
  .flip-card:hover .flip-card-inner {
    transform: rotateY(180deg);
  }

  .col-sm-12>.flip-card {
    margin-bottom: 180px;
  }

  /* Position the front and back side */
  .flip-card-front,
  .flip-card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
  }

  .col-md-4>.flip-card {
    width: auto;
    align-content: center;
  }

  /* Style the back side */
  .flip-card-back {
    transform: rotateY(180deg);
  }

  .col-lg-3 {
    display: inline-block;
    margin-left: -4px;
    margin-top: 8px;
    min-width: 220px;
  }

  .card-text {
    width: 220px;
    height: 70px;
    overflow: hidden;
  }

  .more {
    font-size: 16px;
    margin: 0px auto 3px auto;
    text-align: center;
  }

  .more:hover {
    color: black;
  }

  .price,
  .card-title {
    color: #87142b;
    font-weight: bolder;
  }

  .input-group {
    margin: 2px auto 3px 40px;
  }

  .input-group label {

    margin-right: 30px;
    margin-top: 3px;
    text-transform: capitalize;
  }

  .input-group select {
    width: 250px;
    text-transform: capitalize;
  }

  .input-group-text {
    min-height: 30px;
    background-color: #007bff;
    color: white;
    height: 41px;
  }

  #material {
    display: block;
  }

  .col-sm-3 .card {
    width: 280px;
    margin: auto;
  }

  .category {
    font-family: 'serif,Timesnewroman';
    text-transform: capitalize;
    font-weight: 10px;
    margin-top: 10px;
  }
  .vendorslist a{
    color: white;
    text-transform: capitalize;
    font-style: oblique;
    font-size: large;
  }
  .vendorslist{
    font-family: 'serif,Timesnewroman';
    background-color:#ce3c3f;
    color: white;
    height: max-content;
    margin-top: 86px;
    border: 7px groove darksalmon;
    right: -34px;
    border-left:4px groove blanchedalmond;

  }
</style>
{% endblock %}
{% block body %}
{% if test %}
<div class="alert alert-danger alert-dismissible fade show" role="alert">
  Successfully login
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
{% endif %}
{% load static %}
<div class="bd-example container my-4">
  <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
    <ol class="carousel-indicators">
      <li data-target="#carouselExampleCaptions" data-slide-to="0" class="active"></li>
      <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
      <li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
      <li data-target="#carouselExampleCaptions" data-slide-to="3"></li>
    </ol>
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="{%static '/shoppage/images/dress1.jpg' %}" class="d-block w-100" alt="Bridal dresses">
      </div>
      <div class="carousel-item">
        <img src="{% static '/shoppage/images/dress8.jpg' %}" class="d-block w-100" alt="Bridal dresses">
      </div>
      <div class="carousel-item">
        <img src="{% static '/shoppage/images/dress4.jpg' %}" class="d-block w-100" alt="Bridal dresses">
      </div>
      <div class="carousel-item">
        <img src="{% static '/shoppage/images/dress9.jpeg' %}" class="d-block w-100" alt="Bridal dresses">
      </div>
      <div class="carousel-item">
        <img src="{% static '/shoppage/images/dress10.jpg' %}" class="d-block w-100" alt="Bridal dresses">
      </div>
    </div>

  </div>
</div>
<div class="container marketing">
  <!-- Three columns of text below the carousel -->

  <div class="row my-4">
    <div class="col-sm-12 col-lg-4 col-md-4">
      <div class="flip-card">
        <div class="flip-card-inner">
          <div class="flip-card-front">
            <img class="bd-placeholder-img rounded-circle" width="160" height="160"
              src="{% static '/shoppage/images/dress29.jpg' %}">
            <title>Placeholder</title>
            <h2>A beautiful dress For less</h2>
            <p>We've rounded up some of our favorite wedding retailers to make it easier for you to
              find your dream gown.</p>
            <p><a class="btn btn-secondary" href="#" role="button" style='background-color:#87142b'>View
                details &raquo;</a></p>
          </div>
          <div class="flip-card-back"> <img class="bd-placeholder-img rounded-circle" width="160" height="160"
              src="{% static '/shoppage/images/dress29.jpg' %}">

            <p class="my-4">Finding an affordable wedding dress under $1,000 doesn't have to be a
              challenge, so It
              is the
              best place to snag the dress of your dreams for less.</p>
            <p><a class="btn btn-secondary" href="#" role="button" style='background-color:#87142b'>Shop
                Now &raquo;</a></p>
          </div>
        </div>
      </div>
    </div>

    <!-- /.col-lg-4 -->
    <div class=" col-sm-12 col-lg-4 col-md-4">
      <div class="flip-card">
        <div class="flip-card-inner">
          <div class="flip-card-front">
            <img class="bd-placeholder-img rounded-circle" width="160" height="160"
              src="{% static '/shoppage/images/alter2.jpg' %}">
            <h2>Try on dresses in your size</h2>
            <p> Customize your dress according to your size and material we work on shiffon,silk and
              much more choice is yours. </p>
            <p><a class="btn btn-secondary" href="#" role="button" style='background-color:#87142b'>View
                details &raquo;</a></p>
          </div>
          <div class="flip-card-back">
            <img class="bd-placeholder-img rounded-circle" width="160" height="160"
              src="{% static '/shoppage/images/alter2.jpg' %}">
            <p class="mt-5">Take your measurements and check size guide.</p>
            <p><a class="btn btn-secondary" href="#" role="button" style='background-color:#87142b'>Customize
                dress Now &raquo;</a></p>
          </div>
        </div>
      </div>
    </div><!-- /.col-lg-4 -->
    <div class=" col-sm-12 col-lg-4 col-md-4">
      <div class="flip-card">
        <div class="flip-card-inner">
          <div class="flip-card-front">
            <img class="bd-placeholder-img rounded-circle" width="160" height="160"
              src="{% static '/shoppage/images/Delivery1.jpg' %}">
            <h2>Free Delivery Nationwide
            </h2>
            <p>We provide expedite Free Home Delivery on all orders placed on our website, with minimum
              order of Rs 1,000 in all over the Pakistan. </p>
            <p><a class="btn btn-secondary" href="#" role="button" style='background-color:#87142b'>View
                details &raquo;</a></p>
          </div>
          <div class="flip-card-back">
            <img class="bd-placeholder-img rounded-circle mb-6" width="160" height="160"
              src="{% static '/shoppage/images/Delivery1.jpg' %}">
            <p class="my-4">
              <h3>Contact Us:</h3>
              Email:<a href="https://www.gmail.com" target="_blank">musfirazia250@gmail.com</a>
              Phone:0315-2812098
            </p>
            <p><a class="btn btn-secondary" href="#" role="button" style='background-color:#87142b'>Contact
                Now &raquo;</a></p>
          </div>
        </div>
      </div>
    </div><!-- /.col-lg-4 -->
  </div><!-- /.row -->
</div>
<!-- Available dresses-->
{% load static %}
<div class="container">
<div class="row">
 

    <div class="col-lg-9 col-md-9 col-sm-9">
      {% for product,range,nslides in allProds %}
      <h1 class="category container my-2">{{product.0.category}}</h1>
      <div class="row">
        <div id="demo{{forloop.counter}}" class="col carousel slide my-3" data-ride="carousel">
          <ul class="carousel-indicators">
            <li data-target="#demo{{forloop.counter}}" data-slide-to="0" class="active"></li>

            {% for i in range %}
            <li data-target="#demo{{forloop.parentloop.counter}}" data-slide-to="{{i}}"></li>
            {% endfor %}
            <br>
          </ul>
          <div class="container carousel-inner no-padding">
            <div class="carousel-item active">
              {% for i in product %}
              {% load static %}
              <div class="col-xs-3 col-sm-3 col-md-3">
                <div class="card" style="width: 18rem;">
                  <img src='media/{{i.image}}' class="card-img-top" alt="Dress image">
                  <div class="card-body">
                    <h5 class="card-title" id="namepr{{i.dress_id}}">{{i.dress_name}}</h5>
                    <p class="card-text">{{i.desc|slice:":60"}}<span id="material">Material: {{i.material}}</span>
                      <h6 class="price">Price : <span id="pricepr{{i.dress_id}}">{{i.price}}</span></h6>
                    </p>
                    <span id="divpr{{i.dress_id}}" class='divpr'><button id="pr{{i.dress_id}}"
                        class="btn btn-primary cart">Add to
                        Cart</button></span>
                    <a href='product/{{i.dress_id}}'><button id="qv{{i.dress_id}}" class="btn btn-primary cart"> Quick
                        View</button></a>
                  </div>
                </div>
              </div>
              {% if forloop.counter|divisibleby:3 and forloop.counter > 0 and not forloop.last %}
            </div>
            <div class="carousel-item">
              {% endif %}

              {% endfor %}
            </div>
          </div>
        </div>
        <!-- left and right controls for the slide -->
        <a class="carousel-control-prev" href="#demo{{forloop.counter}}" data-slide="prev">
          <span class="carousel-control-prev-icon"></span>
        </a>
        <a class="carousel-control-next" href="#demo{{forloop.counter}}" data-slide="next">
          <span class="carousel-control-next-icon"></span>
        </a>
      </div>
      {% endfor %}
    </div>

  <div class="vendorslist col-lg-3 col-md-3 col-sm-3">
    <h1>Top Sellers</h1>
    {% for i in vendors  %}
    <p><a href='/vendors/{{i}}'>{{i}}</a></p>
    {% endfor %}
  </div>

</div>
</div>
{% endblock %}

</html>
{% block js %}
<script>
  $(document).ready(function () {
    // show the alert
    setTimeout(function () {
      $(".alert").alert('close');
    }, 2000);
  });

  // Find out the cart items from localStorage
  if (localStorage.getItem('cart') == null) {
    var cart = {};
  } else {
    cart = JSON.parse(localStorage.getItem('cart'));
    updateCart(cart);

  }

  // If the add to cart button is clicked, add/increment the item
  //$('.cart').click(function() {
  $('.divpr').on('click', 'button.cart', function () {
    var idstr = this.id.toString();
    console.log(idstr)
    if (cart[idstr] != undefined) {
      qty = cart[idstr][0] + 1;
    } else {
      qty = 1;
      name = document.getElementById('name' + idstr).innerHTML;
      price = document.getElementById('price' + idstr).innerHTML;
      cart[idstr] = [qty, name, parseInt(price)];

    }
    updateCart(cart);

  });

  //Add Popover to cart
  $('#popcart').popover();


  function updatePopover(cart) {
    var popStr = "";
    popStr = popStr + "<h5> Cart for your items in my shopping cart </h5><div class='mx-2 my-2'>";
    var i = 1;
    for (var item in cart) {
      popStr = popStr + "<b>" + i + "</b>. ";
      console.log(document.getElementById('name' + item).innerHTML)
      popStr = popStr + document.getElementById('name' + item).innerHTML.slice(0, 19) + "... Qty: " + cart[item][0] + '<br>';
      i = i + 1;

    }

    popStr = popStr + "</div> <a href='/checkout'><button class='btn btn-primary' id ='checkout'>Checkout</button></a> <button class='btn btn-primary' onclick='clearCart()' id ='clearCart'>Clear Cart</button>     "
    console.log(popStr);
    document.getElementById('popcart').setAttribute('data-content', popStr);
    $('#popcart').popover('show');

  }

  function clearCart() {
    cart = JSON.parse(localStorage.getItem('cart'));
    for (var item in cart) {
      document.getElementById('div' + item).innerHTML = '<button id="' + item + '" class="btn btn-primary cart">Add To Cart</button>'
    }
    localStorage.clear();
    cart = {};
    updateCart(cart);
  }

  function updateCart(cart) {
    var sum = 0;
    for (var item in cart) {
      sum = sum + cart[item][0];
      document.getElementById('div' + item).innerHTML = "<button id='minus" + item + "' class='btn btn-primary minus'>-</button> <span id='val" + item + "''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-primary plus'> + </button>";

    }
    localStorage.setItem('cart', JSON.stringify(cart));
    document.getElementById('cart').innerHTML = sum;
    console.log(cart);
    updatePopover(cart);
  }

  // If plus or minus button is clicked, change the cart as well as the display value
  $('.divpr').on("click", "button.minus", function () {
    a = this.id.slice(7);
    cart['pr' + a][0] = cart['pr' + a][0] - 1;
    cart['pr' + a][0] = Math.max(0, cart['pr' + a][0]);
    if (cart['pr' + a][0] == 0) {
      document.getElementById('divpr' + a).innerHTML = '<button id="pr' + a + '" class="btn btn-primary cart">Add to Cart</button>';
      delete cart['pr' + a];
    }
    else {
      document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    }
    updateCart(cart);

  });

  $('.divpr').on("click", "button.plus", function () {
    a = this.id.slice(6);
    cart['pr' + a][0] = cart['pr' + a][0] + 1;
    document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    updateCart(cart);
  });
</script>
{% endblock %}